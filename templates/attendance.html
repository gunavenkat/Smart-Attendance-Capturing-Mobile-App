{% load static %}
{% if user.is_authenticated %}

<!DOCTYPE html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ATTENDENCE REGISTER</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href='{% static 'styles/attendance.css' %}?{% now "U" %}'>

</head>

<body bgcolor="cyan">
  <body>
    <div id="navbar">
        <img class="logo" src="../static/images/imag.png">
        <a href="/">HOME</a>
        <a href="/employee">Employee Details</a>
        <a href="/attendance">Attendance Registration</a>
        <a href="/accounts/logout">LOGOUT</a>
    </div>  
    
    <h2>Let's UR ATTENDANCE here</h2>
    
    <form action ='upload' method='post' enctype='multipart/form-data' >
    {% csrf_token %}
      <input type="file" name="image">
      <input type="submit" value='upload file'>
    </form>
        
    <canvas id="CANVAS" name="CANVAS" width="400" height="350">Your browser does not support Canvas.</canvas>
      
        
    <div id="container"  name='cont' class="container-fluid no-padding ">
      <video autoplay="true" id="videoElement" name='vid'>
    
      </video>
    </div>

    <a id="download" download="face.jpg"></form>
    <button onclick="myFunction(); download();" align="center" style="margin: 20px 250px auto " class="btn btn-primary dropdown-toggle" type="button" >capture</button></a>
    <script>

      function download(){
        var download = document.getElementById("download");
        var image = document.getElementById("CANVAS").toDataURL("image/png")
                        .replace("image/jpg", "image/octet-stream");
            download.setAttribute("href", image);
            //download.setAttribute("download","archive.png");
      }
    
    
    
    
    
      var video = document.querySelector("#videoElement");
     
    if (navigator.mediaDevices.getUserMedia) 
    {       
        navigator.mediaDevices.getUserMedia({video: true})
      .then(function(stream) {
        video.srcObject = stream;
      })
      .catch(function(err0r) {
        console.log("Something went wrong!");
      });
    var i=0;
    function myFunction() {
      var x =  document.getElementById("CANVAS") ;
      var ctx = x.getContext("2d");
      ctx.fillStyle = "#FF0000";
      
      ctx.drawImage(video, 0, 0, 400, 350);
    
      //ctx.fillRect(20, 20, 150, 100);
    
      if (i <10)
      {
      document.body.appendChild(x);
      i=i+1;
    };
    
    
    }
    
    }
    </script>
    



</body>
</html>

{% else %}

<head>
  <meta http-equiv="refresh" content="1; URL=/accounts/login" />
</head>
<body>
  <p>If you are not redirected in three seconds, <a href="/accounts/login">click here</a>.</p>
</body>



{% endif %}